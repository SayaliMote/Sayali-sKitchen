{% extends 'base.html' %}

{% block content %}
    <h2>Filtered Products</h2>

    <form method="GET">
        {% for type in types %}
            <h3>{{ type.name }}</h3>
            <ul>
                {% for product in products %}
                    {% if product.type == type %}
                        <li style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <!-- Checkbox -->
                            <input type="checkbox" 
                                   name="selected_products" 
                                   value="{{ product.id }}" 
                                   {% if product.id in selected_products %}checked{% endif %}>

                            <!-- Product Image -->
                            <img src="{{ product.image.url }}" alt="{{ product.name }}" 
     style="width: 80px; height: auto; border-radius: 5px; border: 1px solid #ddd;">


                            <!-- Product Name & Calories as a Link -->
                            <a href="{% url 'shop:product_detail' type_id=product.type.id product_id=product.id %}" 
                               class="custom-link" 
                               style="text-decoration: none; color: black; font-weight: bold;">
                                {{ product.name }} - {{ product.calories }} kcal
                            </a>
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        {% endfor %}

        <h3>Total Selected Calories: <span id="totalCalories">{{ total_calories }}</span> kcal</h3>
    </form>
{% endblock %}
